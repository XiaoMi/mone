import{d as U,u as P,a as S,b as j,r as i,o as C,E as v,_ as E,c as g,e as w,f as F,g as a,w as o,h as p,i as V,j as h,k as y}from"./index-Co6ij2vp.js";import{l as I,r as M}from"./user-CN9QmXqL.js";import"./index-BYulWOv-.js";const B=U({__name:"Login",setup(x,{expose:r}){r();const u=P(),e=S(),f=j(),_=i(),n=i(),t=i(!1),m=i(!0),d=i(e.query.redirect||"/agents"),c=i({username:"",password:""}),b=i({username:"",password:"",email:""}),l=i({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]}),L=i({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}]}),q=async()=>{if(_.value)try{await _.value.validate(),t.value=!0;const s=await I(c.value);if(s.data.code===200){if(f.setToken(s.data.data.token),f.setUser({id:s.data.data.userId,username:s.data.data.username,internalAccount:s.data.data.internalAccount||""}),!s.data.data.internalAccount){d.value&&d.value!=="/agents"?u.push({path:"/bindInner",query:{redirect:d.value}}):u.push("/bindInner");return}v.success("登录成功"),u.push(d.value||"/agents")}else v.error(s.data.message||"登录失败")}catch(s){console.error("Login failed:",s)}finally{t.value=!1}},R=async()=>{if(n.value)try{await n.value.validate(),t.value=!0;const s=await M(b.value);s.data.code===200?(v.success("注册成功"),m.value=!0,e.query.redirect&&u.replace({path:"/login",query:{redirect:e.query.redirect}})):v.error(s.data.message||"注册失败")}catch(s){console.error("Register failed:",s)}finally{t.value=!1}},z=()=>{m.value=!m.value,e.query.redirect&&u.replace({path:"/login",query:{redirect:e.query.redirect}})};C(()=>{particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:800}},color:{value:["#00f0ff","#b400ff"]},shape:{type:"circle"},opacity:{value:.5,random:!0,anim:{enable:!0,speed:1,opacity_min:.1,sync:!1}},size:{value:3,random:!0,anim:{enable:!0,speed:2,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#00f0ff",opacity:.2,width:1},move:{enable:!0,speed:1,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!0,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"grab"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:140,line_linked:{opacity:.5}},push:{particles_nb:4}}},retina_detect:!0})});const k={router:u,route:e,userStore:f,loginFormRef:_,registerFormRef:n,loading:t,isLoginForm:m,redirectPath:d,loginForm:c,registerForm:b,rules:l,registerRules:L,handleLogin:q,handleRegister:R,toggleForm:z};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),N={class:"login-container"},O={key:2,class:"register-link"},A={key:3,class:"register-link"};function T(x,r,u,e,f,_){const n=g("el-input"),t=g("el-form-item"),m=g("el-button"),d=g("el-form"),c=g("el-link"),b=g("el-card");return p(),w("div",N,[r[10]||(r[10]=F("div",{id:"particles-js"},null,-1)),a(b,{class:"login-box"},{header:o(()=>r[5]||(r[5]=[F("div",{class:"card-header"},[F("h2",null,"WELCOME TO LOGIN")],-1)])),default:o(()=>[e.isLoginForm?(p(),V(d,{key:0,ref:"loginFormRef",model:e.loginForm,rules:e.rules,"label-position":"top",onSubmit:h(e.handleLogin,["prevent"])},{default:o(()=>[a(t,{label:"Username",prop:"username"},{default:o(()=>[a(n,{modelValue:e.loginForm.username,"onUpdate:modelValue":r[0]||(r[0]=l=>e.loginForm.username=l),placeholder:"Please enter username","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),a(t,{label:"Password",prop:"password"},{default:o(()=>[a(n,{modelValue:e.loginForm.password,"onUpdate:modelValue":r[1]||(r[1]=l=>e.loginForm.password=l),type:"password",placeholder:"Please enter password","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),a(t,{class:"btn-item"},{default:o(()=>[a(m,{type:"primary","native-type":"submit",class:"login-button",size:"large",loading:e.loading},{default:o(()=>r[6]||(r[6]=[y(" Login ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])):(p(),V(d,{key:1,ref:"registerFormRef",model:e.registerForm,rules:e.registerRules,"label-position":"top",onSubmit:h(e.handleRegister,["prevent"])},{default:o(()=>[a(t,{label:"Username",prop:"username"},{default:o(()=>[a(n,{modelValue:e.registerForm.username,"onUpdate:modelValue":r[2]||(r[2]=l=>e.registerForm.username=l),placeholder:"Please enter username","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),a(t,{label:"Password",prop:"password"},{default:o(()=>[a(n,{modelValue:e.registerForm.password,"onUpdate:modelValue":r[3]||(r[3]=l=>e.registerForm.password=l),type:"password",placeholder:"Please enter password","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),a(t,{label:"Email",prop:"email"},{default:o(()=>[a(n,{modelValue:e.registerForm.email,"onUpdate:modelValue":r[4]||(r[4]=l=>e.registerForm.email=l),placeholder:"Please enter email","prefix-icon":"Mail",size:"large"},null,8,["modelValue"])]),_:1}),a(t,{class:"btn-item"},{default:o(()=>[a(m,{type:"primary","native-type":"submit",class:"login-button",size:"large",loading:e.loading},{default:o(()=>r[7]||(r[7]=[y(" Register ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])),e.isLoginForm?(p(),w("p",O,[a(c,{type:"primary",onClick:e.toggleForm},{default:o(()=>r[8]||(r[8]=[y("Register")])),_:1})])):(p(),w("p",A,[a(c,{type:"primary",onClick:e.toggleForm},{default:o(()=>r[9]||(r[9]=[y("Login")])),_:1})]))]),_:1})])}const X=E(B,[["render",T],["__scopeId","data-v-08aaad4e"],["__file","/Users/zhangzhiyong/IdeaProjects/open/mone/jcommon/hive-manager/src/main/resources/static/src/views/Login.vue"]]);export{X as default};
