import{d as w,r as f,l as V,o as L,E as A,J as M,_ as P,c as p,e as v,f as a,v as F,g as o,w as i,K as j,i as T,T as U,h as m,k as c,F as I,q as W,t as n,s as J}from"./index-Co6ij2vp.js";import{S as K}from"./index-BYulWOv-.js";const O=S=>K({url:"/v1/report/list",method:"post",data:S,headers:{"Content-Type":"application/json"}}),q=w({__name:"ReportList",setup(S,{expose:t}){t();const g=f([]),e=f(!1),R=f(!1),B=f(null),h=f({appName:""}),r=f({page:1,pageSize:20,total:0}),{currentTheme:y}=V(),_=async()=>{e.value=!0;try{const l=await O({appName:h.value.appName||"",page:r.value.page,pageSize:r.value.pageSize});if(l.data.code===200){const d=l.data.data;Array.isArray(d)?(g.value=d,d.length===r.value.pageSize?r.value.total=r.value.page*r.value.pageSize+1:r.value.total=(r.value.page-1)*r.value.pageSize+d.length):d&&typeof d=="object"&&"list"in d?(g.value=d.list||[],r.value.total=d.total||0):(g.value=[],r.value.total=0)}else A.error(l.data.message||"获取调用记录列表失败"),g.value=[],r.value.total=0}catch(l){A.error(l.message||"获取调用记录列表失败"),g.value=[],r.value.total=0}finally{e.value=!1}},u=()=>{r.value.page=1,_()},N=()=>{h.value.appName="",r.value.page=1,_()},z=l=>{r.value.pageSize=l,r.value.page=1,_()},k=l=>{r.value.page=l,_()},D=l=>{B.value=l,R.value=!0},s=l=>l?new Date(l).toLocaleString("zh-CN"):"-",b=l=>({1:"页面",2:"接口",3:"系统内部",4:"调试等"})[l]||`方式${l}`,C=l=>({1:"Agent",2:"Mcp",3:"其他"})[l]||"其他",E=l=>{if(!l)return"-";try{const d=JSON.parse(l);return JSON.stringify(d,null,2)}catch{return l}};L(()=>{_()});const x={reportList:g,loading:e,drawerVisible:R,selectedReport:B,searchForm:h,pagination:r,currentTheme:y,fetchReportList:_,handleSearch:u,handleReset:N,handleSizeChange:z,handlePageChange:k,handleShowDetail:D,formatDate:s,getInvokeWayText:b,getTypeText:C,formatParams:E,get Search(){return M}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),G={class:"report-list-container"},H={class:"dashboard-header"},Q={class:"search-form"},X={class:"table-container"},Y={class:"report-table"},Z={key:0,class:"loading-container"},$={key:"empty",class:"empty-state"},ee=["onClick"],ae={class:"report-info"},te={class:"report-avatar"},se={class:"report-logo-placeholder"},le={class:"report-details"},oe={class:"method-info"},ne={class:"business-info"},re={class:"report-status"},ie={class:"report-meta"},ue={class:"meta-item"},de={class:"meta-value"},ce={class:"meta-item"},pe={class:"meta-value"},me={class:"meta-item"},_e={class:"meta-value"},ge={class:"report-time"},ve={key:0,class:"pagination-container"},fe={key:0,class:"report-detail"},he={class:"params-pre"};function ye(S,t,g,e,R,B){const h=p("el-icon"),r=p("el-input"),y=p("el-button"),_=p("el-pagination"),u=p("el-descriptions-item"),N=p("el-tag"),z=p("el-alert"),k=p("el-descriptions"),D=p("el-drawer");return m(),v("div",G,[t[13]||(t[13]=a("div",{class:"cyber-grid"},null,-1)),t[14]||(t[14]=a("div",{class:"circuit-point point-1"},null,-1)),t[15]||(t[15]=a("div",{class:"circuit-point point-2"},null,-1)),a("div",H,[a("div",Q,[o(r,{modelValue:e.searchForm.appName,"onUpdate:modelValue":t[0]||(t[0]=s=>e.searchForm.appName=s),placeholder:"请输入应用名称",clearable:"",onClear:e.handleSearch,onKeyup:j(e.handleSearch,["enter"]),class:"search-input"},{prefix:i(()=>[o(h,null,{default:i(()=>[o(e.Search)]),_:1})]),_:1},8,["modelValue"]),o(y,{class:"query-btn",onClick:e.handleSearch},{default:i(()=>t[4]||(t[4]=[c("查询")])),_:1}),o(y,{class:"reset-btn",onClick:e.handleReset},{default:i(()=>t[5]||(t[5]=[c("重置")])),_:1})])]),a("div",X,[a("div",Y,[e.loading?(m(),v("div",Z,t[6]||(t[6]=[a("div",{class:"loading-spinner"},null,-1),a("span",null,"加载中...",-1)]))):(m(),T(U,{key:1,name:"list",tag:"div"},{default:i(()=>[e.reportList.length===0?(m(),v("div",$,t[7]||(t[7]=[a("div",{class:"empty-content"},[a("span",{class:"empty-text"},"暂无调用记录")],-1)]))):F("",!0),(m(!0),v(I,null,W(e.reportList,s=>{var b,C;return m(),v("div",{key:`${s.createdAt}-${s.methodName}`,class:"report-card",onClick:E=>e.handleShowDetail(s)},[a("div",ae,[a("div",te,[a("div",se,n(((C=(b=s.appName)==null?void 0:b.charAt(0))==null?void 0:C.toUpperCase())||"R"),1)]),a("div",le,[a("h4",null,n(s.appName||"-"),1),a("p",oe,[t[8]||(t[8]=a("span",{class:"label"},"方法:",-1)),a("span",null,n(s.className)+"."+n(s.methodName),1)]),a("p",ne,[t[9]||(t[9]=a("span",{class:"label"},"业务:",-1)),a("span",null,n(s.businessName||"-"),1)])])]),a("div",re,[a("span",{class:J(["badge",s.success?"success":"failed"])},n(s.success?"成功":"失败"),3)]),a("div",ie,[a("div",ue,[t[10]||(t[10]=a("span",{class:"meta-label"},"执行时间:",-1)),a("span",de,n(s.executionTime)+"ms",1)]),a("div",ce,[t[11]||(t[11]=a("span",{class:"meta-label"},"调用方式:",-1)),a("span",pe,n(e.getInvokeWayText(s.invokeWay)),1)]),a("div",me,[t[12]||(t[12]=a("span",{class:"meta-label"},"主机:",-1)),a("span",_e,n(s.host||"-"),1)])]),a("div",ge,[a("time",null,n(e.formatDate(s.createdAt)),1)])],8,ee)}),128))]),_:1}))])]),!e.loading&&e.reportList.length>0?(m(),v("div",ve,[o(_,{"current-page":e.pagination.page,"onUpdate:currentPage":t[1]||(t[1]=s=>e.pagination.page=s),"page-size":e.pagination.pageSize,"onUpdate:pageSize":t[2]||(t[2]=s=>e.pagination.pageSize=s),"page-sizes":[10,20,50,100],total:e.pagination.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.handleSizeChange,onCurrentChange:e.handlePageChange},null,8,["current-page","page-size","total"])])):F("",!0),o(D,{modelValue:e.drawerVisible,"onUpdate:modelValue":t[3]||(t[3]=s=>e.drawerVisible=s),title:"调用记录详情",size:600,direction:"rtl"},{default:i(()=>[e.selectedReport?(m(),v("div",fe,[o(k,{column:1,border:""},{default:i(()=>[o(u,{label:"应用名称"},{default:i(()=>[c(n(e.selectedReport.appName||"-"),1)]),_:1}),o(u,{label:"业务名称"},{default:i(()=>[c(n(e.selectedReport.businessName||"-"),1)]),_:1}),o(u,{label:"类名"},{default:i(()=>[c(n(e.selectedReport.className||"-"),1)]),_:1}),o(u,{label:"方法名"},{default:i(()=>[c(n(e.selectedReport.methodName||"-"),1)]),_:1}),o(u,{label:"执行状态"},{default:i(()=>[o(N,{type:e.selectedReport.success?"success":"danger"},{default:i(()=>[c(n(e.selectedReport.success?"成功":"失败"),1)]),_:1},8,["type"])]),_:1}),o(u,{label:"执行时间"},{default:i(()=>[c(n(e.selectedReport.executionTime)+"ms ",1)]),_:1}),o(u,{label:"调用方式"},{default:i(()=>[c(n(e.getInvokeWayText(e.selectedReport.invokeWay)),1)]),_:1}),o(u,{label:"类型"},{default:i(()=>[c(n(e.getTypeText(e.selectedReport.type)),1)]),_:1}),o(u,{label:"主机"},{default:i(()=>[c(n(e.selectedReport.host||"-"),1)]),_:1}),o(u,{label:"创建时间"},{default:i(()=>[c(n(e.formatDate(e.selectedReport.createdAt)),1)]),_:1}),o(u,{label:"描述"},{default:i(()=>[c(n(e.selectedReport.description||"-"),1)]),_:1}),o(u,{label:"输入参数"},{default:i(()=>[a("pre",he,n(e.formatParams(e.selectedReport.inputParams)),1)]),_:1}),e.selectedReport.errorMessage?(m(),T(u,{key:0,label:"错误信息"},{default:i(()=>[o(z,{title:e.selectedReport.errorMessage,type:"error",closable:!1},null,8,["title"])]),_:1})):F("",!0)]),_:1})])):F("",!0)]),_:1},8,["modelValue"])])}const Fe=P(q,[["render",ye],["__scopeId","data-v-4f08535f"],["__file","/Users/zhangzhiyong/IdeaProjects/open/mone/jcommon/hive-manager/src/main/resources/static/src/views/ReportList.vue"]]);export{Fe as default};
